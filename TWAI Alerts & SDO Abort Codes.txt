1. TWAI ALERTS — Simple Real-Life Analogies

These alerts tell you what went wrong at the hardware CAN level.

Alert	Simple Meaning	Analogy (Conference Room)
TX_FAILED	Message could not be delivered	You spoke, but nobody nodded to confirm they heard → you repeat 16 times → still no one → you give up
TX_RETRIED	Had to retry sending	You started speaking but someone else spoke louder (higher priority) → you wait → then retry
RX_FIFO_OVERRUN	Hardware received too many frames	Too many people talking at once → your ears couldn’t keep up, you missed some
RX_DATA_OVERFLOW	Software queue overflow	You heard people but you forgot to write down what they said because your notepad was full
BUS_ERROR	Bit error, CRC error, form error	Someone mumbled, mispronounced, or gave corrupted info → conversation error
ERR_WARN	Error counters reached warning	You have had too many misunderstandings recently → you’re getting nervous
ERR_PASS	Controller moved to error-passive	You messed up enough times that you now talk quieter to avoid disturbing the meeting
BUS_OFF	Controller disabled itself	You messed up too many times → you are kicked out of the room for a while
BUS_RECOVERED	Returned from bus-off	You were outside cooling off → now allowed back in
ARBITRATION_LOST	Lost the bus arbitration	You tried speaking but someone higher priority spoke first, so you stop and retry
TX_IDLE	No TX in progress	Nobody is speaking
RX_FRAME	Frame received	Someone just said something correctly and clearly
2. SDO ABORT CODES — SIMPLE ENGLISH MEANINGS

These refer to application layer errors at the CANopen device side.

Think of them like “polite rejection letters” from the device’s Object Dictionary.

Abort Code	Meaning	Simple Analogy
0x05040005	Out of memory	Device: “I don’t have space for this.”
0x05040006	Unsupported access	“You cannot do this action.”
0x06010000	Unsupported object	“This thing doesn’t exist in my dictionary.”
0x06010001	Cannot read	“This is write-only.”
0x06010002	Cannot write	“This is read-only.”
0x06020000	Object does not exist	“Wrong file number.”
0x06090030	Value range exceeded	“You’re asking for a value I can’t accept.”
0x08000000	General error	“Something went wrong. No idea what.”
0x06040043	Length mismatch	“Your message size is wrong.”
0x06070010	Data type mismatch	“Wrong format. I expected integer, not string.”
0x06090011	Subindex invalid	“This folder doesn’t have this sub-file index.”
0x06090012	Only partial data	“You didn’t provide everything I needed.”
0x060A0023	Hardware error	“My internal hardware failed.”



ChatGPT said:

Below is a crisp, Work-mode, bottom-up, practical explanation of how ALL types of SDO abort codes and ESP32 TWAI (CAN) alerts get generated, and exactly what inside your system can trigger them.

1. HOW SDO ABORT CODES ARE GENERATED

(Only CANopen layer — not CAN controller)

Think of SDO like “a courier service” delivering a parcel (your data) from Client (your ESP32) to Server (the slave device).
An SDO Abort Code = a return-back slip saying “delivery failed because XYZ”.

SDO abort codes are generated ONLY by software in the SDO server (slave) OR your own SDO client parser.
THE CAN hardware never generates SDO aborts.

A. WHO generates an SDO Abort?
1. The Remote Device (SDO Server)

If:

request format is wrong

address wrong

object doesn’t exist

access not allowed

data length mismatch

device busy

device internal error

timeout
Then slave returns a CAN frame with:

COB-ID = 0x580 + nodeId

Data[0] = 0x80 (abort)

Data[1..4] = Abort Code

This is like courier saying: customer refused the parcel.

2. YOU (SDO Client) detect timeout

If:

No response in time
You create the abort yourself:

“SDO timeout” type error

This is like parcel lost, courier never came back.

B. WHAT CONDITIONS generate which SDO abort codes?
1. 0x05030000 — Toggle bit not alternated

Cause:

Corrupted segmented transfer

Slave expected toggle=1, you sent 0 or vice-versa
Generated because:

Bad implementation

Bit flip due to noise

2. 0x05040000 — SDO command specifier error

Cause:

Wrong first byte (CS)

Request format invalid
Generated when:

You send wrong protocol bytes

Frame corrupted

3. 0x06010000 — Object does not exist

Cause:

Wrong index/subindex

Wrong dictionary access
Slave returns this.

4. 0x06010002 — Attempt to read a write-only object

Cause:

Trying to read write-only object.

5. 0x06010003 — Attempt to write a read-only object
6. 0x06020000 — Object cannot be mapped

PDO mapping invalid.

7. 0x06040041 — Data type error

Cause:

Expected UINT16, you sent 3 bytes.

Length mismatch.

8. 0x06070010 — Data length too short
9. 0x06070012 — Data length too long
10. 0x06090011 — Subindex doesn’t exist

Wrong subindex.

11. 0x08000000 — General error

Remote device internal error.

12. 0x08000020 — Data cannot be transferred

Slave blocked/busy/faulted.

13. 0x05040005 — Out-of-memory
2. HOW TWAI (ESP32 CAN) ALERTS ARE GENERATED

(TWAI driver + CAN Controller).

Think of CAN Controller like a traffic cop at the junction.
Alert = the cop blowing a whistle.

A. Common Alerts and What Triggers Them
1. TWAI_ALERT_TX_SUCCESS

Triggered when:

Frame was ACKed by at least one other CAN node

No CAN errors during transmission

This means “packet delivered successfully on the bus”.

2. TWAI_ALERT_TX_FAILED / TX_RETRY

Triggered when:

No node ACKs the frame

Dominant/recessive errors

Bus heavy noise

Bus-off/reset condition
This is like nobody responded to your shout.

3. TWAI_ALERT_RX_DATA

Triggered when:

A valid CAN frame arrives and passes CRC/bit-stuffing checks.

4. TWAI_ALERT_ERR_PASS

Triggered when:

CAN controller error counter > 127

Due to repeated:

Bit errors

ACK errors

CRC errors

Arbitration losses

5. TWAI_ALERT_BUS_ERROR

Triggered when:

CAN protocol rules violated:

Bit stuffing error

CRC error

Form error

ACK error

This is corrupted traffic.

6. TWAI_ALERT_RX_QUEUE_FULL

Triggered when:

You don’t read messages fast enough

ISR queue fills

7. TWAI_ALERT_TX_QUEUE_FULL

Triggered when:

You push more tx frames than driver queue capacity.

8. TWAI_ALERT_BUS_OFF

Triggered when:

Transmit errors > 255
CAN interface shuts down.
Caused by:

No ACKs

Bus short

Dominant stuck line

Disconnected cable

Wrong bitrate

9. TWAI_ALERT_RECOVERY

Triggered when:

Bus-off recovery state complete.

3. HOW THESE FAILURES HAPPEN — Combined CANopen + CAN Level
SDO abort codes

Triggered by:

Wrong index/subindex

Wrong access type

Wrong data length

Bad command specifier

Device internal fault

Timeout

Bad toggle

Object dictionary errors

Segmentation mismatch

Node in NMT not operational

Device busy

PDO conflicts

Wrong COB-ID

TWAI alerts (CAN controller)

Triggered by:

Physical wire cut

Loose connector

Poor ground reference

Bit rate mismatch

High noise

Arbitration loss

No ACK from any node

Bus line short to battery/ground

Power failure mid-transmission

Queue overflows

Bad ISR handling

Driver reset

4. HOW SDO Abort Codes + TWAI Alerts Connect
Path of a failing SDO request:

1. You send SDO CAN Frame → CAN controller → Bus
Failures here:

TWAI_ALERT_TX_FAILED

TWAI_ALERT_BUS_ERROR

TWAI_ALERT_BUS_OFF

Arbitration lost

Wrong baud rate

Wire noise

2. Slave receives it → parses SDO → Application-level failure
Failures here:

Wrong object → 0x06010000

Wrong length → 0x06070010/12

Access denied → 0x06010002/03

3. Slave tries to send SDO response back
Failure:

Nothing comes → you generate timeout abort

4. You parse response
If data[0] == 0x80 → SDO abort from slave.

In 1 LINE SUMMARY

SDO abort codes = logical/application errors detected in CANopen layer

TWAI alerts = electrical, protocol, hardware, timing, or queue errors detected in CAN layer

Both combined = full picture of CAN reliability.